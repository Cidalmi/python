{% extends 'bolsa_familia/base.html' %}

{% block content %}
<!--Load the AJAX API-->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">
	var data_py = {{ data| escapejs}};
	console.log(data_py);
	var list_array = [['municipio', 'valor']];
	for (var prop in data_py) {
		console.log(data_py[prop].municipio);
		console.log(data_py[prop].valor);
		list_array.push([data_py[prop].municipio, data_py[prop].valor])
	};

	google.charts.load('visualization', '1', {
		'packages': ['corechart']
	});
	google.charts.setOnLoadCallback(drawChart);

	function drawChart() {

		var data = google.visualization.arrayToDataTable(list_array);


		var options = {
			//width: 1000,			
			height: 800,
			title: "Top 15 cidades com maior arrecadação do Bolsa Família",

			hAxis: {
				title: 'Municipio',
			},
			vAxis: {
				title: 'Valor recebido',
				format: 'short'
			},
			titleTextStyle: {
				fontSize: 20
			},
			bar: { groupWidth: '50%' },
			legend: {
				position: 'none'
			},
		};

		var chart = new google.visualization.ColumnChart(document.getElementById('ColumnChart'));
		chart.draw(data, options);
	}
</script>

<nav class="navbar navbar-expand-lg navbar navbar-dark bg-dark">
	<a href="{% url 'index' %}" class="navbar-brand">Bolsa Familia</a>
	<button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse1">
		<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse" id="navbarCollapse1">
		<div class="navbar-nav">
			<a href="{% url 'index' %}" class="nav-item nav-link active">Home</a>
		</div>
	</div>
</nav>
<div class="container">
	<div class="row col-sm-12 col-md-12">
		<h2 class="text-center"><u>Bolsa Familia</u></h2><br>
		<table class="table table-dark table-striped">
			<thead>
				<tr>
					<th></th>
					<th>municipio</th>
					<th>periodo</th>
					<th>quantidadeBeneficiados</th>
					<th>valor</th>
				</tr>
			</thead>
			<tbody>
				{% if data %}
				{% for i in data %}
				<tr>
					<td>{{i.index}}</td>
					<td>{{i.municipio}}</td>
					<td>{{i.periodo}}</td>
					<td>{{i.quantidadeBeneficiados}}</td>
					<td>{{i.valor}}</td>
				</tr>
				{% endfor %}
				{% endif %}
			</tbody>
		</table>
	</div>
	<div class="row">
		<div class='ttools col-sm-12 col-md-12'>
			<!-- <pre><img src="data:image/png;base64,{{ uri }}"> </pre> -->
		</div>
	</div>


	<div class="row">
		<div class="col-md-12">
			<h1>Grafico</h1>
			<div class="chart" id="ColumnChart"></div>
		</div>
	</div>
</div>

<br><br>Result : {{data|escapejs}}<h id='result'></h>

{% endblock %}


<div class="container-fluid">



</div>